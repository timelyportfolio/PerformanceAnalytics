<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Functions for calculating shrinkage-based comoments of financial time series — ShrinkageMoments â€¢ PerformanceAnalytics</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PerformanceAnalytics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pa-charts.html">PerformanceAnalytics Charts and Tables Overview</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/braverock/PerformanceAnalytics">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions for calculating shrinkage-based comoments of financial time series</h1>
    </div>

    
    <p>calculates covariance, coskewness and cokurtosis matrices using linear shrinkage
between the sample estimator and a structured estimator</p>
    

    <pre class="usage"><span class='fu'>M2.shrink</span>(<span class='no'>R</span>, <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>f</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>M3.shrink</span>(<span class='no'>R</span>, <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>f</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>unbiasedMSE</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>as.mat</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>M4.shrink</span>(<span class='no'>R</span>, <span class='kw'>targets</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>f</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>as.mat</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>R</th>
      <td><p>an xts, vector, matrix, data frame, timeSeries or zoo object of
asset returns</p></td>
    </tr>
    <tr>
      <th>targets</th>
      <td><p>vector of integers selecting the target matrices to shrink to. The first four
structures are, in order: 'independent marginals', 'independent and identical marginals', 
'observed 1-factor model' and 'constant correlation'. See Details.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>vector or matrix with observations of the factor, to be used with target 3. See Details.</p></td>
    </tr>
    <tr>
      <th>unbiasedMSE</th>
      <td><p>TRUE/FALSE whether to use a correction to have an unbiased
estimator for the marginal skewness values, in case of targets 1 and/or 2, default FALSE</p></td>
    </tr>
    <tr>
      <th>as.mat</th>
      <td><p>TRUE/FALSE whether to return the full moment matrix or only
the vector with the unique elements (the latter is advised for speed), default
TRUE</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The coskewness and cokurtosis matrices are defined as the matrices of dimension 
p x p^2 and p x p^3 containing the third and fourth order central moments. They
are useful for measuring nonlinear dependence between different assets of the 
portfolio and computing modified VaR and modified ES of a portfolio.</p>
<p>Shrinkage estimation for the covariance matrix was popularized by Ledoit and 
Wolf (2003, 2004). An extension to coskewness and cokurtosis matrices by
Martellini and Ziemann (2010) uses the 1-factor and constant-correlation structured
comoment matrices as targets. In Boudt, Cornilly and Verdonck (2017) the framework
of single-target shrinkage for the coskewness and cokurtosis matrices is 
extended to a multi-target setting, making it possible to include several target matrices
at once. Also, an option to enhance small sample performance for coskewness estimation
was proposed, resulting in the option 'unbiasedMSE' present in the 'M3.shrink' function.</p>
<p>The first four target matrices of the 'M2.shrink', 'M3.shrink' and 'M4.shrink' 
correspond to the models 'independent marginals', 'independent and identical marginals', 
'observed 1-factor model' and 'constant correlation'. Coskewness shrinkage includes two
more options, target 5 corresponds to the latent 1-factor model proposed in Simaan (1993)
and target 6 is the coskewness matrix under central-symmetry, a matrix full of zeros.
For more details on the targets, we refer to Boudt, Cornilly and Verdonck (2017) and
the supplementary appendix.</p>
<p>If f is a matrix containing multiple factors, then the shrinkage estimator will
use each factor in a seperate single-factor model and use multi-target shrinkage
to all targets matrices at once.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Boudt, Kris, Brian G. Peterson, and Christophe Croux. 2008.
Estimation and Decomposition of Downside Risk for Portfolios with Non-Normal
Returns. Journal of Risk. Winter.</p>
<p>Boudt, Kris, Cornilly, Dries and Verdonck, Tim. 2017. A Coskewness Shrinkage 
Approach for Estimating the Skewness of Linear Combinations of Random Variables. 
Submitted. Available at SSRN: https://ssrn.com/abstract=2839781</p>
<p>Ledoit, Olivier and Wolf, Michael. 2003. Improved estimation of the covariance matrix 
of stock returns with an application to portfolio selection. Journal of empirical 
finance, 10(5), 603-621.</p>
<p>Ledoit, Olivier and Wolf, Michael. 2004. A well-conditioned estimator for large-dimensional 
covariance matrices. Journal of multivariate analysis, 88(2), 365-411.</p>
<p>Martellini, Lionel and Ziemann, V\"olker. 2010. Improved estimates of higher-order 
comoments and implications for portfolio selection. Review of Financial 
Studies, 23(4), 1467-1502.</p>
<p>Simaan, Yusif. 1993. Portfolio selection and asset pricing: three-parameter framework. 
Management Science, 39(5), 68-577.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>CoMoments</code>  <code><a href='StructuredMoments.html'>StructuredMoments</a></code>  <code><a href='EWMAMoments.html'>EWMAMoments</a></code>  <code><a href='MCA.html'>MCA</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>data</span>(<span class='no'>edhec</span>)

<span class='co'># construct an underlying factor (market-factor, observed factor, PCA, ...)</span>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'>rowSums</span>(<span class='no'>edhec</span>)

<span class='co'># multi-target shrinkage with targets 1, 3 and 4</span>
<span class='co'># as.mat = F' would speed up calculations in higher dimensions</span>
<span class='no'>targets</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>4</span>)
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'>M2.shrink</span>(<span class='no'>edhec</span>, <span class='no'>targets</span>, <span class='no'>f</span>)$<span class='no'>M2sh</span>
<span class='no'>m3</span> <span class='kw'>&lt;-</span> <span class='fu'>M3.shrink</span>(<span class='no'>edhec</span>, <span class='no'>targets</span>, <span class='no'>f</span>)$<span class='no'>M3sh</span>
<span class='no'>m4</span> <span class='kw'>&lt;-</span> <span class='fu'>M4.shrink</span>(<span class='no'>edhec</span>, <span class='no'>targets</span>, <span class='no'>f</span>)$<span class='no'>M4sh</span>

<span class='co'># compute equal-weighted portfolio modified ES</span>
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'>colMeans</span>(<span class='no'>edhec</span>)
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>length</span>(<span class='no'>mu</span>)
<span class='fu'><a href='ES.html'>ES</a></span>(<span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>portfolio_method</span> <span class='kw'>=</span> <span class='st'>"component"</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span> / <span class='no'>p</span>, <span class='no'>p</span>), <span class='kw'>mu</span> <span class='kw'>=</span> <span class='no'>mu</span>,
    <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>sigma</span>, <span class='kw'>m3</span> <span class='kw'>=</span> <span class='no'>m3</span>, <span class='kw'>m4</span> <span class='kw'>=</span> <span class='no'>m4</span>)</div><div class='output co'>#&gt; $MES
#&gt; [1] 0.03418537
#&gt; 
#&gt; $contribution
#&gt;  [1]  0.0052837933 -0.0002137705  0.0035375067  0.0072299562  0.0010344300
#&gt;  [6]  0.0034968193  0.0032865974  0.0017118492  0.0036208050  0.0014452126
#&gt; [11]  0.0029590724 -0.0025796747  0.0033727718
#&gt; 
#&gt; $pct_contrib_MES
#&gt;  [1]  0.154563005 -0.006253274  0.103480140  0.211492707  0.030259437
#&gt;  [6]  0.102289940  0.096140469  0.050075493  0.105916804  0.042275764
#&gt; [11]  0.086559616 -0.075461369  0.098661268
#&gt; </div><div class='input'>
<span class='co'># compare to sample method</span>
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'>cov</span>(<span class='no'>edhec</span>)
<span class='no'>m3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='CoMoments.html'>M3.MM</a></span>(<span class='no'>edhec</span>)
<span class='no'>m4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='CoMoments.html'>M4.MM</a></span>(<span class='no'>edhec</span>)
<span class='fu'><a href='ES.html'>ES</a></span>(<span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>portfolio_method</span> <span class='kw'>=</span> <span class='st'>"component"</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span> / <span class='no'>p</span>, <span class='no'>p</span>), <span class='kw'>mu</span> <span class='kw'>=</span> <span class='no'>mu</span>,
    <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>sigma</span>, <span class='kw'>m3</span> <span class='kw'>=</span> <span class='no'>m3</span>, <span class='kw'>m4</span> <span class='kw'>=</span> <span class='no'>m4</span>)</div><div class='output co'>#&gt; $MES
#&gt; [1] 0.03241585
#&gt; 
#&gt; $contribution
#&gt;  [1]  0.0074750513 -0.0028125166  0.0039422674  0.0069376579  0.0008077760
#&gt;  [6]  0.0037114666  0.0043125937  0.0007173036  0.0036152960  0.0013693293
#&gt; [11]  0.0037650911 -0.0048178690  0.0033924063
#&gt; 
#&gt; $pct_contrib_MES
#&gt;  [1]  0.23059863 -0.08676361  0.12161541  0.21402052  0.02491917  0.11449542
#&gt;  [7]  0.13303965  0.02212817  0.11152864  0.04224258  0.11614968 -0.14862694
#&gt; [13]  0.10465269
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Dries Cornilly

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Brian G. Peterson, Peter Carl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
